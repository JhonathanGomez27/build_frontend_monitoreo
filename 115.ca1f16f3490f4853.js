"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[115],{9115:(Y,d,i)=>{i.r(d),i.d(d,{default:()=>P});var f=i(6814),r=i(6223),u=i(4170),Z=i(2296),v=i(617),C=i(4516),l=i(5313),y=i(8645),g=i(9773),b=i(3620),x=i(1476),h=i(553),t=i(9212),A=i(6593),m=i(1474),D=i(5619),R=i(9397);let T=(()=>{class e{constructor(){this.url=h.N.url,this.limit=h.N.pagination,this._httpCliente=(0,t.f3M)(m.eN),this._logs=new D.X(null)}set logs(o){this._logs.next(o)}get logs$(){return this._logs.asObservable()}getAllLogs(o){let a=new m.LE;return a=a.append("page",o),a=a.append("limit",this.limit),this._httpCliente.post(`${this.url}logs/getLogs`,{},{params:a}).pipe((0,R.b)(s=>{this._logs.next(s)}))}getLogsPaginated(o,a){let s=new m.LE;return s=s.append("page",o),s=s.append("limit",this.limit),this._httpCliente.post(`${this.url}logs/getLogs`,a,{params:s})}static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var L=i(8109);function w(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1," Tipo de Ingreso "),t.qZA())}function S(e,n){if(1&e&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.accion," ")}}function U(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1," Descripcion "),t.qZA())}function F(e,n){if(1&e&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.descripcion," ")}}function Q(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1," Usuario "),t.qZA())}function I(e,n){if(1&e&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.usuario," ")}}function J(e,n){1&e&&(t.TgZ(0,"th",25),t._uU(1," Fecha "),t.qZA())}function N(e,n){if(1&e&&(t.TgZ(0,"td",26),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.fecha,"medium")," ")}}function j(e,n){1&e&&t._UZ(0,"tr",27)}function z(e,n){1&e&&t._UZ(0,"tr",28)}const P=[{path:"",component:(()=>{class e{constructor(o,a,s,c,p){this.titleService=o,this._logsService=a,this._changeDetectorRef=s,this.activatedRoute=c,this.router=p,this._unsubscribeAll=new y.x,this.displayedColumns=["tipo_ingreso","usuario","descripcion","fecha"],this.dataSource=new l.by([]),this.searchControl=new r.p4,this.diasControl=new r.p4,this.loading=!1,this.logs=[],this.totalLogs=0,this.page=0,this.limit=h.N.pagination,this.debounce=1500,this.titleService.setTitle("Relator\xeda | Monitoreo Logs")}ngOnInit(){this._logsService.logs$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(o=>{this.logs=o.logs,this.totalLogs=o.total,this.dataSource=new l.by(this.logs),this._changeDetectorRef.markForCheck()}),this.activatedRoute.queryParams.subscribe(o=>{o.page?(this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{page:o.page}}),this.page=parseInt(o.page)-1):(this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{page:"1"}}),this.page=0)}),this.searchControl.valueChanges.pipe((0,b.b)(this.debounce),(0,g.R)(this._unsubscribeAll)).subscribe(o=>{this.loading||this.aplicarFiltro(0),this._changeDetectorRef.markForCheck()}),this.diasControl.valueChanges.pipe((0,b.b)(this.debounce),(0,g.R)(this._unsubscribeAll)).subscribe(o=>{this.loading||this.aplicarFiltro(0),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}aplicarFiltro(o){this.page=o;let a=o+1;this.loading=!0;let s={usuario:this.searchControl.value||"",cantidadDias:this.diasControl.value||""};this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:{page:a}}),this._logsService.getLogsPaginated(a,s).pipe((0,g.R)(this._unsubscribeAll)).subscribe(c=>{this._logsService.logs=c,this.loading=!1,this._changeDetectorRef.markForCheck()},c=>{this.loading=!1,this._changeDetectorRef.markForCheck()})}handlePageChangeEvent(o){this.aplicarFiltro(o.pageIndex)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(A.Dx),t.Y36(T),t.Y36(t.sBO),t.Y36(L.gz),t.Y36(L.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-logs"]],standalone:!0,features:[t.jDz],decls:35,vars:18,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto","bg-white"],[1,"flex-auto","p-6","sm:px-26","sm:py-10"],[1,"min-h-100"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-center","items-start","mb-6","w-full"],[1,"text-4xl","font-semibold","text-primary-700"],[1,"w-full","grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","gap-3"],[1,"col-span-1","md:col-span-2"],[1,"fuse-mat-rounded","fuse-mat-dense","w-full",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","formControl","placeholder"],["searchInput",""],[1,"col-span-1","flex","flex-row","gap-2","items-center"],["matInput","","type","number","min","0",3,"autocomplete","formControl","placeholder"],[1,"overflow-x-auto","mt-4"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","tipo_ingreso"],["mat-header-cell","","class","text-lg",4,"matHeaderCellDef"],["mat-cell","","class","text-lg",4,"matCellDef"],["matColumnDef","descripcion"],["matColumnDef","usuario"],["matColumnDef","fecha"],["mat-header-row","","class","border-b-4 border-solid border-primary",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"w-full","flex","justify-end"],[1,"bg-transparent",3,"length","pageIndex","pageSize","showFirstLastButtons","disabled","page"],["mat-header-cell","",1,"text-lg"],["mat-cell","",1,"text-lg"],["mat-header-row","",1,"border-b-4","border-solid","border-primary"],["mat-row",""]],template:function(a,s){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),t._uU(5,"Registros de Usuarios"),t.qZA()(),t.TgZ(6,"div",5)(7,"div",6)(8,"mat-form-field",7),t._UZ(9,"mat-icon",8)(10,"input",9,10),t.qZA()(),t.TgZ(12,"div",11)(13,"mat-form-field",7),t._UZ(14,"mat-icon",8)(15,"input",12,10),t.qZA()()(),t.TgZ(17,"div",13)(18,"table",14),t.ynx(19,15),t.YNc(20,w,2,0,"th",16)(21,S,2,1,"td",17),t.BQk(),t.ynx(22,18),t.YNc(23,U,2,0,"th",16)(24,F,2,1,"td",17),t.BQk(),t.ynx(25,19),t.YNc(26,Q,2,0,"th",16)(27,I,2,1,"td",17),t.BQk(),t.ynx(28,20),t.YNc(29,J,2,0,"th",16)(30,N,3,4,"td",17),t.BQk(),t.YNc(31,j,1,0,"tr",21)(32,z,1,0,"tr",22),t.qZA()(),t.TgZ(33,"div",23)(34,"mat-paginator",24),t.NdJ("page",function(p){return s.handlePageChangeEvent(p)}),t.qZA()()()()()),2&a&&(t.xp6(8),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("autocomplete","off")("formControl",s.searchControl)("placeholder","Buscar usuario"),t.xp6(3),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:calendar"),t.xp6(1),t.Q6J("autocomplete","off")("formControl",s.diasControl)("placeholder","Dias busqueda"),t.xp6(3),t.Q6J("dataSource",s.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(2),t.Q6J("length",s.totalLogs)("pageIndex",s.page)("pageSize",s.limit)("showFirstLastButtons",!0)("disabled",s.loading))},dependencies:[f.ez,f.uU,u.lN,u.KE,u.qo,Z.ot,v.Ps,v.Hw,C.c,C.Nt,r.u5,r.Fj,r.wV,r.JJ,r.qQ,r.UX,r.oH,l.p0,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,x.TU,x.NW],encapsulation:2})}return e})(),resolve:{comisiones:(e,n)=>{let o=e.queryParamMap.get("page")||"1";return(0,t.f3M)(T).getAllLogs(o)}}}]}}]);